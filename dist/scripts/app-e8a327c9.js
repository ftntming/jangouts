"use strict";angular.module("janusHangouts",["ngAnimate","ngCookies","ngTouch","ngSanitize","blockUI","ui.router","ui.bootstrap","ngEmbed","cfp.hotkeys","janusHangouts.config","gridster","ngAudio","LocalStorageModule","angular-extended-notifications"]).config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("signin",{url:"/sign_in?room",templateUrl:"app/signin/signin.html",controller:"SigninController",controllerAs:"vm",resolve:{StatesService:"StatesService",setRoomAndService:["StatesService","$state",function(e,t){return e.setRoomAndUser(t.toParams)}]}}).state("room",{url:"/rooms/:room?user",templateUrl:"app/room/room.html",controller:"RoomCtrl",resolve:{StatesService:"StatesService",setRoomAndService:["StatesService","$state",function(e,t){return e.setRoomAndUser(t.toParams)}]},onEnter:["UserService","RoomService",function(e,t){e.setSetting("lastRoom",t.getRoom().id)}]}),t.otherwise("/sign_in")}]).config(["blockUIConfig",function(e){e.templateUrl="app/room/consent-dialog.html",e.cssClass="block-ui block-ui-anim-fade consent-dialog",e.autoBlock=!1}]).config(["notificationsProvider",function(e){e.setDefaults({templatesDir:"app/templates/",faIcons:!0,closeOnRouteChange:"state"})}]).config(["localStorageServiceProvider",function(e){e.setPrefix("jh")}]).config(["$provide",function(e){e.decorator("$state",["$delegate","$rootScope",function(e,t){return t.$on("$stateChangeStart",(function(t,n,o){e.toParams=o})),e}])}]).run(["$http","jhConfig",function(e,t){var n=new XMLHttpRequest;if(n.open("GET","config.json",!1),n.send(null),200===n.status){var o=JSON.parse(n.responseText);angular.forEach(o,(function(e,n){t[n]=function(e){return"string"==typeof e?e.replace("%{hostname}",window.location.host):e}(e)}))}else console.warn("No configuration found")}]).run(["EventsService",function(e){e.init()}]).run(["PluginsService",function(e){e.initPlugins()}]).run(["$rootScope","$state","RoomService",function(e,t,n){e.$on("$stateChangeStart",(function(){n.leave()})),e.$on("$stateChangeError",(function(){t.go("signin")}))}]),function(){function e(e,t){return{restrict:"EA",templateUrl:function(e,t){var n="app/components/videochat/buttons/jh-thumbnails-mode-button";return t.textTemplate?n+"-with-text.html":n+".html"},scope:{},controllerAs:"vm",bindToController:!0,controller:function(){this.click=function(){t((function(){e.videoThumbnails=!e.videoThumbnails}))},this.isChecked=function(){return e.videoThumbnails}}}}angular.module("janusHangouts").directive("jhThumbnailsModeButton",e),e.$inject=["jhConfig","$timeout"]}(),angular.module("janusHangouts").directive("jhResizeModeButton",(function(){return{restrict:"EA",templateUrl:"app/components/videochat/buttons/jh-resize-mode-button.html",scope:{toggleFn:"&",resetFn:"&",resizeModeOn:"="},controllerAs:"vm",bindToController:!0,controller:function(){var e=this;e.toggle=function(){e.toggleFn()},e.reset=function(){e.resetFn()},e.showsReset=function(){return e.resizeModeOn},e.title=function(){return e.resizeModeOn?"Save layout":"Change screen layout"}}}})),angular.module("janusHangouts").provider("CallstatsProvider",(function(){var e={AppID:null,AppSecret:null,debug:!1,callstats:null,log:function(){this.debug&&console.log.apply(this,arguments)},initializeCallstats:function(e){var t=this;this.log("Received localUserID: ",e);var n=this.callstats.initialize(this.AppID,this.AppSecret,e,(function(e,n){t.log("Initialize return status: errCode= "+e+" errMsg= "+n)}),(function(e){var n;for(n in t.log("These are Initialize recieved stats: ",e),e.streams){t.log("SSRC is: ",n);var s=e.streams[n];t.log("SSRC Type ",s.reportType),s.reportType===i?t.log("RTT is: ",s.rtt):s.reportType===o&&t.log("Inbound loss rate is: ",s.fractionLoss)}}),s);this.log("callstats.initialize response object",n);var o="inbound",i="outbound",s={disableBeforeUnloadHandler:!1,applicationVersion:"0.4.6"}},sendPCObject:function(e,t,n){var o=this;this.log("Send PC Object Parameters: ",e,t,n);var i=this.callstats.fabricUsage.multiplex;t&&n&&e?this.callstats.addNewFabric(e,t,i,n,(function(e,t){o.log("Monitoring status: "+e+" msg: "+t)})):this.log("ERROR: Faulty Parameters! ",e,t,n)},reportErrors:function(e,t,n,o){this.log("::: reporting error ::: ",n,o),this.callstats.reportError(e,t,this.callstats.webRTCFunctions[o],n)},sendEvents:function(e,t,n){this.log("::: Sending Event ::: ",n),this.callstats.sendFabricEvent(e,this.callstats.fabricEvent[n],t)},subscribeToEventsSubject:function(e){var t=this;e.subscribe(function(e){switch(t.log("Received Event: ",e),e.type){case"user":"joining"===e.data.status&&this.initializeCallstats(e.user.username);break;case"subscriber":break;case"stream":("local"===e.data.stream&&"main"===e.data.for||"remote"===e.data.stream&&"subscriber"===e.data.for)&&this.sendPCObject(e.data.peerconnection,"Janus",e.room.description);break;case"screenshare":"started"===e.data.status?this.sendEvents(e.data.peerconnection,e.room.description,"screenShareStart"):"stopped"===e.data.status&&this.sendEvents(e.data.peerconnection,e.room.description,"screenShareStop");break;case"channel":var n=null;n="audio"===e.data.channel?"audio"+(e.data.status?"Unmute":"Mute"):"video"+(e.data.status?"Resume":"Pause"),this.sendEvents(e.data.peerconnection,e.room.description,n);break;case"pluginHandle":if("detached"===e.data.status&&["main","subscriber"].includes(e.data.for)){var o=e.data.pluginHandle.webrtcStuff.pc;this.sendEvents(o,e.room.description,"fabricTerminated")}break;case"error":"createOffer"===e.data.status?this.reportErrors(e.data.peerconnection,e.room.description,e.data.error,"createOffer"):"createAnswer"===e.data.status&&this.reportErrors(e.data.peerconnection,e.room.description,e.data.error,"createAnswer");break;default:t.log("Unknown type of event: ",e)}}.bind(this))}};return{$get:function(){return e},$set:function(t,n){e[t]=n}}})),function(){function e(e,t,n,o,i){this.init=function(){(function(){var o=e[0],i=t.defer(),s=o.createElement("script");return s.src="https://api.callstats.io/static/callstats.min.js",o.body.appendChild(s),s.onload=s.onreadystatechange=function(e){s.readyState&&!["complete","loaded"].includes(s.readyState)||n((function(){i.resolve(e)}))},s.onerror=function(e){n((function(){i.reject(e)}))},i.promise})().then((function(){!function(){var e=new XMLHttpRequest;if(e.open("GET","config.callstats.json",!1),e.send(null),200===e.status){var t=JSON.parse(e.responseText);angular.forEach(t,(function(e,t){i[t]=e}))}else console.warn("No Callstats configuration found!")}(),i.callstats=new window.callstats,null!==i.callstats&&void 0!==i.callstats||console.error("Something went wrong loading callstats.min.js!"),i.subscribeToEventsSubject(o.getEventsSubject())})).catch((function(){console.error("Could not load callstats.min.js!")}))}}angular.module("janusHangouts").service("CallstatsPlugin",e),e.$inject=["$document","$q","$timeout","EventsService","CallstatsProvider"]}(),function(){function e(e){return{restrict:"EA",templateUrl:"app/components/feed/buttons/jh-video-button.html",scope:{feed:"="},controllerAs:"vm",bindToController:!0,controller:function(){var t=this;t.toggle=function(){e.toggleChannel("video",t.feed)},t.showsEnable=function(){return t.feed&&t.feed.isPublisher&&!t.feed.getVideoEnabled()},t.showsDisable=function(){return t.feed&&t.feed.isPublisher&&t.feed.getVideoEnabled()}}}}angular.module("janusHangouts").directive("jhVideoButton",e),e.$inject=["RoomService"]}(),function(){function e(e){return{restrict:"EA",templateUrl:"app/components/feed/buttons/jh-unpublish-button.html",scope:{feed:"="},controllerAs:"vm",bindToController:!0,controller:function(){var t=this;t.click=function(){e.unPublishFeed(t.feed.id)},t.isVisible=function(){return t.feed.isPublisher&&t.feed.isLocalScreen}}}}angular.module("janusHangouts").directive("jhUnpublishButton",e),e.$inject=["RoomService"]}(),angular.module("janusHangouts").directive("jhStickyButton",(function(){return{restrict:"EA",templateUrl:"app/components/feed/buttons/jh-sticky-button.html",scope:{feed:"=",clickFn:"&",highlighted:"=",sticky:"="},controllerAs:"vm",bindToController:!0,controller:function(){var e=this;e.click=function(){e.clickFn()},e.showsEnable=function(){return!e.sticky&&!e.feed.isIgnored&&e.feed.isConnected()},e.showsDisable=function(){return e.sticky}}}})),function(){function e(e,t,n,o){return{restrict:"E",templateUrl:"app/components/feed/buttons/jh-pushtotalk-button.html",controllerAs:"vm",controller:function(){var i=!1,s=this;function r(n){if(null!==s.hotkey&&(t.del(s.hotkey,"keydown"),t.del(s.hotkey,"keyup"),s.hotkey=null,s.showHotkey=!1,s.titleText="Set Push-to-talk hotkey"),null!==n){var i=function(t){t.preventDefault(),e.pushToTalk(t.type)};t.add({combo:n,description:"Push-to-talk",callback:i,action:"keydown"}),t.add({combo:n,description:"Push-to-talk",callback:i,action:"keyup"}),s.hotkey=n,s.showHotkey=!0,s.titleText="Disable Push-to-talk"}o.setSetting("lastHotkey",n)}s.hotkeyActive=!1,s.showHotkey=!1,s.hotkey=null,s.titleText="Set Push-to-talk hotkey",s.click=function(e){i||(e.currentTarget.blur(),s.hotkeyActive?(null!==s.hotkey?r(null):window.Mousetrap.stopRecord(),s.hotkeyActive=!1):(s.hotkeyActive=!0,function(){s.toggleText="Press hotkey";var e=function(e){var t;s.toggleText="",null!=e&&void 0!==e[0]&&e[0].length>0?e[0].indexOf("+")>-1&&1!==e[0].length||"\\"===e[0]?(t="Sorry, key combinations are not supported!",s.toggleText=t,i=!0,n((function(){s.toggleText="",s.hotkeyActive=!1,i=!1}),3e3)):r(e[0]):s.hotkeyActive=!1};window.Mousetrap.record({recordSequence:!1},(function(t){e(t)}))}()))},s.isRecording=function(){return s.toggleText&&""!==s.toggleText},a=o.getSetting("lastHotkey"),a&&(s.hotkeyActive=!0,r(a));var a},scope:{}}}angular.module("janusHangouts").directive("jhPushtotalkButton",e),e.$inject=["RoomService","hotkeys","$timeout","UserService"]}(),function(){function e(e){return{restrict:"EA",templateUrl:"app/components/feed/buttons/jh-ignore-button.html",scope:{feed:"="},controllerAs:"vm",bindToController:!0,controller:function(){var t=this;t.ignore=function(){e.ignoreFeed(t.feed.id)},t.stopIgnoring=function(){e.stopIgnoringFeed(t.feed.id)},t.showsIgnore=function(){return!t.feed.isPublisher&&!t.feed.isIgnored},t.showsStopIgnoring=function(){return t.feed.isIgnored}}}}angular.module("janusHangouts").directive("jhIgnoreButton",e),e.$inject=["RoomService"]}(),angular.module("janusHangouts").directive("jhIgnoreAudioButton",(function(){return{restrict:"EA",templateUrl:"app/components/feed/buttons/jh-ignore-audio-button.html",scope:{feed:"="},controllerAs:"vm",bindToController:!0,controller:function(){var e=this;function t(){return!e.feed.isPublisher&&!e.feed.isIgnored&&e.feed.hasTrack("audio")}e.toggle=function(){e.feed.setEnabledTrack("audio",!e.feed.isTrackEnabled("audio"))},e.showsIgnore=function(){return t()&&e.feed.isTrackEnabled("audio")},e.showsStopIgnoring=function(){return t()&&!e.feed.isTrackEnabled("audio")}}}})),function(){function e(e,t){return{restrict:"EA",templateUrl:"app/components/feed/buttons/jh-audio-button.html",scope:{feed:"=",withMonitor:"="},controllerAs:"vm",bindToController:!0,controller:function(){var n=this;n.toggle=function(){var o=n.feed;e.toggleChannel("audio",o),!o.isPublisher||o.isLocalScreen||o.getAudioEnabled()||t.dismissLastNotification()},n.showsEnable=function(){var e=n.feed;return!(!e||!e.isConnected())&&(e.isPublisher&&!e.isLocalScreen&&!e.getAudioEnabled())},n.showsDisable=function(){var e=n.feed;return!(!e||!e.isConnected())&&(!e.isIgnored&&e.getAudioEnabled())},n.showsAudioOff=function(){var e=n.feed;return!(!e||!e.isConnected())&&(!e.isPublisher&&!e.isIgnored&&!e.getAudioEnabled())},n.isSpeaking=function(){return n.withMonitor&&n.feed&&n.feed.getSpeaking()}}}}angular.module("janusHangouts").directive("jhAudioButton",e),e.$inject=["RoomService","MuteNotifier"]}(),function(){function e(e,t,n,o,i,s,r){return{restrict:"EA",templateUrl:"app/components/videochat/jh-video-chat.html",scope:{},controllerAs:"vm",bindToController:!0,link:function(e,t){e.$on("gridster-resized",(function(){e.vm.adjustAllSizes()})),r((function(){e.vm.adjustAllSizes()}),600),e.$watch("vm.gridsterItems",(function(){e.vm.gridsterIgnoreNextChange?e.vm.gridsterIgnoreNextChange=!1:e.vm.gridsterDirtyBit=!0,r((function(){e.vm.adjustAllSizes()}),600)}),!0),e.$watch((function(){return $("#thumbnails .thumb",t).size()}),(function(){e.vm.adjustFeedsSizes()}))},controller:function(){var e=this;function r(){var e,t,n,o,i=$(window).width()-25,s=$(window).height()-33-20-5,r=i/16,a=Math.floor(s/r);return a<6&&(a=6),a<10?(e=Math.ceil(a/2),t=Math.floor(a/2),n=e,o=8):(e=a,t=a-6,n=6,o=0),[{size:[8,6],position:[0,0],content:"Speaker"},{size:[8,e],position:[0,8],content:"Participants"},{size:[8,t],position:[n,o],content:"Chat"}]}function a(){var e,t,n,o=$("#thumbnails"),i=o.innerWidth(),s=o.innerHeight(),r=$(".thumb",o).size(),a=!0;for(e=128;e>=64;e-=4)if(n=.75*e+33,t=Math.floor(i/(e+4)),Math.ceil(r/t)*n<=s){a=!1;break}e<64&&(e=64),$(".face",o).css({height:.75*e+"px",width:e+"px"}),a?o.css({"overflow-y":"scroll"}):o.css({"overflow-y":"hidden"})}e.gridsterDirtyBit=!1,e.gridsterIgnoreNextChange=!0,e.gridsterItems=o.getSetting("gridsterItems")||r(),e.gridsterOpts={columns:16,resizable:{enabled:!1},draggable:{enabled:!1}},e.highlight={byUser:null,current:null},e.feeds=function(){return n.allFeeds()},e.mainFeed=function(){return n.findMain()},e.highlightedFeed=function(){if(null!==e.highlight.byUser)e.highlight.current=e.highlight.byUser;else{var t=e.highlight.current;if(t&&!t.isConnected()&&(t=null),!(t&&t.getSpeaking()&&t.getVideoEnabled())){var o=n.speakingFeed();o&&o.getVideoEnabled()?e.highlight.current=o:e.highlight.current=t||n.findMain()}}return e.highlight.current},e.mirrored=function(){var t=e.highlightedFeed();return!!t&&(t.isPublisher&&!t.isLocalScreen)},e.toggleHighlightedFeed=function(t){e.highlight.byUser!==t?e.highlight.byUser=t:e.highlight.byUser=null},e.isHighlighted=function(t){return t===e.highlight.current},e.isHighlightedByUser=function(t){return t===e.highlight.byUser},e.logEntries=function(){return t.allEntries()},e.adjustAllSizes=function(){$(".gridster-item").each((function(e,t){var n,o,i,s;n=$(t),i=n.innerWidth(),s=n.innerHeight(),(o=$("#main-video video",n)).length&&o.css({height:s+"px",width:i+"px"}),(o=$("#jh-chat-messages",n)).length&&o.css({height:s-40+"px"}),(o=$("#thumbnails",n)).length&&(o.css({height:s+"px",width:i+"px"}),a())}))},e.adjustFeedsSizes=a,e.showHotkeys=function(){s.toggleCheatSheet()},e.windowResizeModeOn=!1,e.toggleWindowResizeMode=function(){e.windowResizeModeOn=!e.windowResizeModeOn,e.gridsterOpts.resizable.enabled=e.windowResizeModeOn,e.gridsterOpts.draggable.enabled=e.windowResizeModeOn,e.windowResizeModeOn?i.info("Drag to rearrange and resize the screen areas. Then click 'Save layout' to return to normal mode."):(e.gridsterDirtyBit&&(o.setSetting("gridsterItems",e.gridsterItems),i.info("Your layout has been successfully saved")),e.gridsterDirtyBit=!1)},e.setDefaultLayout=function(){(e.gridsterDirtyBit||void 0!==o.getSetting("gridsterItems"))&&(e.gridsterIgnoreNextChange=!0,e.gridsterDirtyBit=!1,e.gridsterItems=r(),o.removeSetting("gridsterItems"),i.info("Your layout preferences have been deleted"))}}}}angular.module("janusHangouts").directive("jhVideoChat",e),e.$inject=["$window","LogService","FeedsService","UserService","Notifier","hotkeys","$timeout"]}(),function(){function e(e,t){this.user=null,this.settings=e.get("userSettings")||{},this.getUser=function(){return this.user},this.signin=function(e){this.setSetting("lastUsername",e),this.user={username:e},t.setUser(this.user)},this.getSettings=function(){return this.settings},this.getSetting=function(e){return this.settings[e]},this.removeSetting=function(e){delete this.settings[e],this.storeSettings()},this.clearSettings=function(){return this.settings={},e.clearAll("userSettings")},this.setSetting=function(e,t){this.settings[e]=t,this.storeSettings()},this.storeSettings=function(){e.set("userSettings",this.settings)},this.enteredPin=null,this.getPin=function(){return this.enteredPin},this.setPin=function(e){this.enteredPin=e},this.privateId=null,this.getPrivateId=function(){return this.privateId},this.setPrivateId=function(e){this.privateId=e}}angular.module("janusHangouts").service("UserService",e),e.$inject=["localStorageService","EventsService"]}(),function(){function e(e,t,n){return{restrict:"EA",templateUrl:"app/components/user/jh-signin-form.html",scope:!0,link:function(e,t){setTimeout((function(){$("#inputUsername",t).focus()}),100),e.vm.adjustHeight(),$(window).on("resize",(function(){e.vm.adjustHeight()}))},controllerAs:"vm",bindToController:!0,controller:function(){var o=this;o.signin=function(){o.room&&o.username&&(n.setPin(o.enteredPin),e.go("room",{room:o.room.id,user:o.username}))},o.adjustHeight=function(){var e=$(window).outerHeight()-$("footer").outerHeight();$("#signin").css({height:e+"px"})},o.showRoomsList=function(){return!0===o.listRooms},o.showRoom=function(){return!1===o.listRooms},o.username=null,o.room=null,o.rooms=[],o.listRooms=null,o.enteredPin=null,t.getRooms().then((function(e){if(o.room=t.getRoom(),o.rooms=e,o.listRooms=null===o.room,null!==n.getUser()&&(o.username=n.getUser().username),null===o.room){var i=n.getSetting("lastRoom");o.room=_.find(e,(function(e){return e.id===i}))}}))}}}angular.module("janusHangouts").directive("jhSigninForm",e),e.$inject=["$state","RoomService","UserService"]}(),function(){function e(e,t){this.inProgress=!1,this.setInProgress=function(t){var n=this;e((function(){n.inProgress=t}))},this.getInProgress=function(){return this.inProgress},this.showHelp=function(){t.open({animation:!0,templateUrl:"app/components/screen-share/screen-share-help.html",controller:"ScreenShareHelpCtrl",controllerAs:"vm"})}}angular.module("janusHangouts").service("ScreenShareService",e),e.$inject=["$timeout","$uibModal"]}(),function(){function e(e){this.close=function(){e.dismiss("cancel")},this.hostname=function(){return window.location.hostname}}angular.module("janusHangouts").controller("ScreenShareHelpCtrl",e),e.$inject=["$uibModalInstance"]}(),function(){function e(e,t,n){return{restrict:"EA",templateUrl:"app/components/screen-share/jh-screen-share-sub-button.html",scope:{source:"=",icon:"=",label:"="},controllerAs:"vm",bindToController:!0,controller:function(){var o=this;o.click=function(){o.enabled()&&t.publishScreen(o.source)},o.enabled=function(){return n.usingSSL()&&!e.getInProgress()},o.title=function(){return o.enabled()?o.label:e.getInProgress()?"Wait while the screen is shared":"Screen sharing disabled (no SSL?)"}}}}angular.module("janusHangouts").directive("jhScreenShareSubButton",e),e.$inject=["ScreenShareService","RoomService","RequestService"]}(),function(){function e(e,t){return{restrict:"EA",templateUrl:"app/components/screen-share/jh-screen-share-hint.html",scope:!0,controllerAs:"vm",bindToController:!0,controller:function(){var n=this;n.showHelp=function(){e.showHelp()},n.usingSSL=function(){return t.usingSSL()},n.httpsUrl=function(){return t.httpsUrl()},n.visible=function(){return n.usingSSL()||n.httpsUrl()}}}}angular.module("janusHangouts").directive("jhScreenShareHint",e),e.$inject=["ScreenShareService","RequestService"]}(),angular.module("janusHangouts").directive("jhScreenShareButton",(function(){return{restrict:"EA",templateUrl:"app/components/screen-share/jh-screen-share-button"+(window.navigator.mozGetUserMedia?"-moz":"")+".html",scope:!0,controllerAs:"vm",bindToController:!0,controller:function(){}}})),function(){function e(e,t,n){this.setRoomAndUser=function(o){var i=e.defer(),s=o.user||n.getSetting("lastUsername");void 0!==s&&n.signin(s);var r=parseInt(o.room);return Number.isNaN(r)?(t.setRoom(null),i.resolve()):t.getRooms().then((function(e){var n=_.find(e,(function(e){return e.id===r}));t.setRoom(n||null),i.resolve()})),i.promise}}angular.module("janusHangouts").service("StatesService",e),e.$inject=["$q","RoomService","UserService"]}(),function(){function e(e){this.usingSSL=function(){return"https:"===window.location.protocol},this.httpsUrl=function(){return e.httpsAvailable?e.httpsUrl?e.httpsUrl:"https://"+window.location.hostname+window.location.pathname:null}}angular.module("janusHangouts").service("RequestService",e),e.$inject=["jhConfig"]}(),angular.module("janusHangouts").factory("Room",(function(){return function(e){e=e||{},_.assign(this,e),this.id=this.room,this.label=this.description+" ("+this.num_participants+"/"+this.max_publishers+" users)"}})),function(){function e(e,t,n,o,i,s,r,a,l,c,u,d,h){this.enter=function(n){var i=e.defer();return v().then((function(){!function(e){var n=t,i=null;h.setRoom(g.room),h.emitEvent({type:"user",data:{status:"joining"}}),g.janus.attach({plugin:"janus.plugin.videoroom",success:function(t){h.emitEvent({type:"pluginHandle",data:{status:"attached",for:"main",pluginHandle:t}}),(i=new s(t,g.room.id,"main")).register(e,d.getPin())},error:function(e){console.error("Error attaching plugin... "+e)},consentDialog:function(e){console.log("Consent dialog should be "+(e?"on":"off")+" now"),n.$broadcast("consentDialog.changed",e),e||f&&n.$broadcast("muted.Join")},ondataopen:function(){console.log("The publisher DataChannel is available"),i.onDataOpen(),y()},onlocalstream:function(e){console.log(" ::: Got a local stream :::"),h.emitEvent({type:"stream",data:{stream:"local",for:"main",peerconnection:i.pluginHandle.webrtcStuff.pc}}),o.findMain().setStream(e)},oncleanup:function(){console.log(" ::: Got a cleanup notification: we are unpublished now :::")},onmessage:function(t,o){var s=t.videoroom;if(console.log("Event: "+s),"joined"===s)console.log("Successfully joined room "+t.room),h.emitEvent({type:"user",data:{status:"joined"}}),d.setPrivateId(t.private_id),a.enterRoom(t.id,e,i),w(l.joinUnmutedLimit)&&(f=S(t.publishers)&&t.publishers.length>=l.joinUnmutedLimit),i.publish({muted:f,error:function(){i.publish({noCamera:!0,muted:f})}}),S(t.attendees)&&g.addFeeds(t.attendees,!1),S(t.publishers)&&g.addFeeds(t.publishers,!0);else if("destroyed"===s)console.log("The room has been destroyed!"),n.$broadcast("room.destroy");else if("event"===s){if(S(t.publishers)&&g.addFeeds(t.publishers,!0),w(t.joining)&&g.addFeed(t.joining.id,t.joining.display,!1),w(t.leaving)){var r=t.leaving;a.destroyFeed(r)}if(w(t.unpublished)){var c=t.unpublished;a.unpublishFeed(c)}t.configured&&i.confirmConfig(),w(t.error)&&(console.log("Error message from server"+t.error),n.$broadcast("room.error",t.error))}w(o)&&i.handleRemoteJsep(o)}})}(n),i.resolve()})),i.promise},this.leave=function(){a.leaveRoom()},this.setRoom=function(e){this.room=e},this.getRoom=function(){return this.room},this.getRooms=function(){var t=e.defer();null===this.rooms?v().then((function(){(function(){var t=e.defer();return g.janus.attach({plugin:"janus.plugin.videoroom",success:function(e){console.log("getAvailableRooms plugin attached ("+e.getPlugin()+", id="+e.getId()+")");e.send({message:{request:"list"},success:function(n){if(e.detach(),"success"===n.videoroom){var o=_.map(n.list,(function(e){return new i(e)}));o=_.sortBy(o,"label"),t.resolve(o)}else t.reject()}})}}),t.promise})().then((function(e){g.rooms=e,t.resolve(e)}))})):t.resolve(this.rooms);return t.promise},this.publishScreen=function(e){var t,n,i=o.findMain().display;h.emitEvent({type:"screenshare",data:{status:"starting"}}),this.janus.attach({plugin:"janus.plugin.videoroom",success:function(n){h.emitEvent({type:"pluginHandle",data:{status:"attached",for:"screen",pluginHandle:n}}),(t=new s(n,g.room.id,e)).register(i,d.getPin()),c.setInProgress(!0)},error:function(e){console.error("  -- Error attaching screen plugin... "+e)},onlocalstream:function(e){console.log(" ::: Got the screen stream :::"),o.find(n).setStream(e),h.emitEvent({type:"stream",data:{stream:"local",for:"screen",peerconnection:t.pluginHandle.webrtcStuff.pc}}),h.emitEvent({type:"screenshare",data:{status:"started",peerconnection:t.pluginHandle.webrtcStuff.pc}}),e.oninactive=function(){h.emitEvent({type:"screenshare",data:{status:"stopped",peerconnection:t.pluginHandle.webrtcStuff.pc}}),b(n),c.setInProgress(!1)}},onmessage:function(e,o){console.log(" ::: Got a message (screen) :::"),console.log(e),"joined"===e.videoroom?(n=e.id,a.publishScreen(n,i,t),t.publish({success:function(){c.setInProgress(!1)},error:function(e){console.log(e),b(n),c.setInProgress(!1),c.showHelp()}})):e.configured?t.confirmConfig():console.log("Unexpected event for screen"),w(o)&&t.handleRemoteJsep(o)}})},this.unPublishFeed=b,this.ignoreFeed=function(e){a.ignoreFeed(e)},this.stopIgnoringFeed=function(e){this.subscribeToFeed(e)},this.addFeeds=function(e,t){if(0===e.length)return;console.log("Got a list of available feeds ("+t+"):"),console.log(e);for(var n=0;n<e.length;n++){var o=e[n].id,i=e[n].display;console.log("  >> ["+o+"] "+i),this.addFeed(o,i,t)}},this.addFeed=function(e,t,n){var i=o.find(e);n?(null===i||i.waitingForConnection())&&this.subscribeToFeed(e,t):null===i&&a.remoteJoin(e,t,null)},this.subscribeToFeed=function(e,t){var i=o.find(e),c=null;i&&(t=i.display);h.emitEvent({type:"subscriber",data:{status:"subscribing",to:t}}),this.janus.attach({plugin:"janus.plugin.videoroom",success:function(t){h.emitEvent({type:"pluginHandle",data:{status:"attached",for:"subscriber",pluginHandle:t}}),(c=new s(t,g.room.id,"subscriber")).listen(e,d.getPin(),d.getPrivateId())},error:function(e){console.error("  -- Error attaching plugin... "+e)},onmessage:function(o,s){console.log(" ::: Got a message (subscriber) :::"),console.log(JSON.stringify(o));var r=o.videoroom;console.log("Event: "+r),"attached"===r?(h.emitEvent({type:"subscriber",data:{status:"susbscribed",to:t}}),n((function(){i?a.connectToFeed(e,c):a.remoteJoin(e,t,c),console.log("Successfully attached to feed "+e+" ("+t+") in room "+o.room)}))):o.configured?c.confirmConfig():o.started?c.setConfig({values:{audio:!0,data:!0,video:l.videoThumbnails}}):428===o.error_code?(console.log("We tried to subscribe to a feed that is not publishing (an attendee)"),a.stopIgnoringFeed(e)):console.log("What has just happened?!"),w(s)&&c.subscribe(s)},onremotestream:function(t){h.emitEvent({type:"stream",data:{stream:"remote",for:"subscriber",peerconnection:c.pluginHandle.webrtcStuff.pc}}),o.waitFor(e).then((function(e){e.setStream(t)}),(function(e){console.error(e)}))},ondataopen:function(){console.log("The subscriber DataChannel is available"),c.onDataOpen(),y()},ondata:function(t){console.log(" ::: Got info in the data channel (subscriber) :::"),r.receiveMessage(t,e)},oncleanup:function(){console.log(" ::: Got a cleanup notification (remote feed "+e+") :::")}})},this.toggleChannel=function(e,t){a.toggleChannel(e,t)},this.pushToTalk=function(e){p&&n.cancel(p);p=n((function(){a.setMedia("audio",!1),m=!1}),1e3),"keydown"!==e||m?"keyup"===e&&(a.setMedia("audio",!1),m=!1,n.cancel(p)):(a.setMedia("audio",!0),m=!0)},this.room=null,this.rooms=null,this.janus=null;var g=this,f=!1,m=!1,p=null;function v(){var t=e.defer();return null===g.janus?(Janus.init({debug:l.janusDebug}),g.janus=new Janus({server:g.server,withCredentials:l.janusWithCredentials,success:function(){t.resolve()},error:function(e){var n="Janus error: "+e;n+="\nDo you want to reload in order to retry?",t.reject(),window.confirm(n)&&window.location.reload()},destroyed:function(){console.log("Janus object destroyed")}})):t.resolve(),t.promise}function b(e){a.destroyFeed(e)}function y(){o.publisherFeeds().forEach((function(e){r.sendStatus(e,{exclude:"picture"}),n((function(){r.sendStatus(e)}),4e3)}))}function w(e){return null!=e}function S(e){return e instanceof Array}l.janusServer?this.server=l.janusServer:this.server=function(){var e,t;u.usingSSL()?(e="wss:",t="8989"):(e="ws:",t="8188");return[e+"//"+window.location.hostname+":"+t+"/janus/",window.location.protocol+"//"+window.location.hostname+"/janus/"]}(),l.janusServerSSL&&u.usingSSL()&&(this.server=l.janusServerSSL)}angular.module("janusHangouts").service("RoomService",e),e.$inject=["$q","$rootScope","$timeout","FeedsService","Room","FeedConnection","DataChannelService","ActionService","jhConfig","ScreenShareService","RequestService","UserService","EventsService"]}(),function(){function e(e){this.entries=[],this.add=function(t){var n=this;e((function(){n.entries.push(t)}))},this.allEntries=function(){return this.entries}}angular.module("janusHangouts").service("LogService",e),e.$inject=["$timeout"]}(),angular.module("janusHangouts").factory("LogEntry",["$sanitize",function(e){return function(t,n){this.type=t,this.timestamp=new Date,this.content=n||{},this.text=function(){return this[this.type+"Text"]()},this.muteRequestText=function(){var e;return e=this.content.source.isPublisher?"You have muted ":this.content.source.display+" has muted ",this.content.target.isPublisher?e+="you":e+=this.content.target.display,e},this.chatMsgText=function(){return e(this.content.text).trim()},this.publishScreenText=function(){return"Screen sharing started"},this.destroyFeedText=function(){return this.content.feed.isLocalScreen?"Screen sharing stopped":this.content.feed.display+" has left the room"},this.newRemoteFeedText=function(){return this.content.feed.display+" has joined the room"},this.ignoreFeedText=function(){return"You are ignoring "+this.content.feed.display+" now"},this.stopIgnoringFeedText=function(){return"You are not longer ignoring "+this.content.feed.display},this.hasText=function(){return""!==this.text()}}}]),function(){function e(e){return{restrict:"EA",templateUrl:"app/components/room/jh-room-info.html",scope:{},controllerAs:"vm",bindToController:!0,controller:function(){this.name=function(){var t=e.getRoom();return t?t.description:""}}}}angular.module("janusHangouts").directive("jhRoomInfo",e),e.$inject=["RoomService"]}(),function(){function e(e,t){return{restrict:"EA",templateUrl:"app/components/room/jh-leave-button.html",scope:!0,controller:function(){this.leave=function(){t.setRoom(null),e.go("signin")}},controllerAs:"vm"}}angular.module("janusHangouts").directive("jhLeaveButton",e),e.$inject=["$state","RoomService"]}(),function(){function e(e,t,n,o){function i(t,n){var o=JSON.stringify({type:t,content:n}),i=e.findMain();null!==i&&(i.isDataOpen()?i.connection.sendData({text:o,error:function(e){alert(e)},success:function(){console.log("Data sent: "+t)}}):console.log("Data channel not open yet. Skipping"))}this.sendStatus=function(e,t){i("statusUpdate",{source:e.id,status:e.getStatus(t)})},this.sendMuteRequest=function(e){i("muteRequest",{target:e.id})},this.sendChatMessage=function(e){i("chatMsg",e)},this.receiveMessage=function(i,s){var r,a,l=JSON.parse(i),c=l.type,u=l.content;"chatMsg"===c?(a=new t("chatMsg",{feed:e.find(s),text:u})).hasText()&&n.add(a):"muteRequest"===c?((r=e.find(u.target)).isPublisher&&r.setEnabledChannel("audio",!1,{after:function(){o.$broadcast("muted.byRequest")}}),a=new t("muteRequest",{source:e.find(s),target:r}),n.add(a)):"statusUpdate"===c?(r=e.find(u.source))&&!r.isPublisher&&r.setStatus(u.status):console.log("Unknown data type: "+c)}}angular.module("janusHangouts").service("DataChannelService",e),e.$inject=["FeedsService","LogEntry","LogService","$rootScope"]}(),function(){function e(e,t,n,o,i,s,r){this.enterRoom=function(e,o,i){var s=new t({display:o,connection:i,id:e,isPublisher:!0});n.add(s,{main:!0})},this.leaveRoom=function(){var e=this;_.forEach(n.allFeeds(),(function(t){e.destroyFeed(t.id)}))},this.remoteJoin=function(e,s,r){var a=new t({display:s,connection:r,id:e,isPublisher:!1});n.add(a);var l=new o("newRemoteFeed",{feed:a});i.add(l)},this.connectToFeed=function(e,t){var o=n.find(e);if(null===o)return;o.isIgnored&&this.stopIgnoringFeed(e);o.setConnection(t)},this.destroyFeed=function(t){var s=n.find(t);if(null===s)return;e((function(){s.disconnect(),n.destroy(t)}));var r=new o("destroyFeed",{feed:s});i.add(r)},this.unpublishFeed=function(t){var o=n.find(t);if(null===o)return;e((function(){o.disconnect()}))},this.ignoreFeed=function(e){var t=n.find(e);if(null===t)return;t.ignore();var s=new o("ignoreFeed",{feed:t});i.add(s)},this.stopIgnoringFeed=function(e){var t=n.find(e);if(null===t)return;t.setIsIgnored(!1);var s=new o("stopIgnoringFeed",{feed:t});i.add(s)},this.writeChatMessage=function(e){var t=new o("chatMsg",{feed:n.findMain(),text:e});t.hasText()&&(i.add(t),s.sendChatMessage(e))},this.publishScreen=function(e,s,r){var a=new t({display:s,connection:r,id:e,isPublisher:!0,isLocalScreen:!0});n.add(a);var l=new o("publishScreen");i.add(l)},this.toggleChannel=function(e,t){if(!t&&!(t=n.findMain()))return;if(!t.isPublisher){var s=new o("muteRequest",{source:n.findMain(),target:t});i.add(s)}if(t.isEnabled(e)){var a=null;"audio"===e&&t.isPublisher&&(a=function(){r.$broadcast("muted.byUser")}),t.setEnabledChannel(e,!1,{after:a})}else t.setEnabledChannel(e,!0)},this.setMedia=function(e,t){var o=n.findMain();if(!o)return;o.setEnabledChannel(e,t)}}angular.module("janusHangouts").service("ActionService",e),e.$inject=["$timeout","Feed","FeedsService","LogEntry","LogService","DataChannelService","$rootScope"]}(),function(){function e(e,t){this.initPlugins=function(){e.enabledPlugins&&e.enabledPlugins.includes("callstats")&&(console.info("Initializing CallstatsPlugin"),t.init())}}angular.module("janusHangouts").service("PluginsService",e),e.$inject=["jhConfig","CallstatsPlugin"]}(),function(){function e(e){this.info=function(t){e.info("Information",t,{duration:5e3,attachTo:$("#videochat-body")})}}angular.module("janusHangouts").service("Notifier",e),e.$inject=["notifications"]}(),function(){function e(e,t,n,o,i){this.speaking=function(){c("Trying to say something? You are muted.")},this.muted=function(){c("You have been muted by another user.")},this.joinedMuted=function(){var e="You are muted because ";0===i.joinUnmutedLimit?e+="everyone who enters a room is muted by default.":1===i.joinUnmutedLimit?e+="there is already one participant in the room.":e+="there are already "+i.joinUnmutedLimit+" participants in the room.";c(e)},this.dismissLastNotification=function(){null!==a&&a.close()};var s=n.load("assets/sounds/bell.ogg"),r={},a=null,l=!1;function c(e){if(!(e in r)&&!l){var n=t.info("Muted",e,{show:function(){l=!0,s.play()},close:function(){l=!1,a=null},duration:2e4,attachTo:$("#videochat-body"),actions:[{label:"Unmute",className:"btn btn-default",fn:function(){o.toggleChannel("audio"),n.close()}},{label:"Don't show again",className:"btn btn-default",fn:function(){r[e]=!0,n.close()}}]});a=n}}}angular.module("janusHangouts").service("MuteNotifier",e),e.$inject=["$animate","notifications","ngAudio","ActionService","jhConfig"]}(),angular.module("janusHangouts").directive("jhFooter",(function(){return{restrict:"EA",templateUrl:"app/components/footer/jh-footer.html",scope:!0}})),function(){function e(e){return function(t,n){var o=(n=n||{}).interval||65,i=n.threshold||-50,s=new(window.AudioContext||window.webkitAudioContext),r=s.createAnalyser();r.fftSize=512,r.smoothingTimeConstant=.1;var a=new window.Float32Array(r.fftSize);s.createMediaStreamSource(t).connect(r);var l=!1,c=_.fill(new Array(10),0),u=e((function(){"suspended"===s.state?s.resume():function(){var e=function(){r.getFloatFrequencyData(a);for(var e=4,t=a.length;e<t;e++)if(a[e]>i&&a[e]<0)return!0;return!1}();e&&!l?_.sum(_.slice(c,c.length-3))>=2&&(l=!0,n.start&&n.start()):!e&&l&&0===_.sum(c)&&(l=!1,n.stop&&n.stop());c.shift(),c.push(0+e)}()}),o);this.destroy=function(){e.cancel(u)},this.isSpeaking=function(){return l}}}angular.module("janusHangouts").factory("SpeakObserver",e),e.$inject=["$interval"]}(),angular.module("janusHangouts").directive("jhMainFeed",(function(){return{restrict:"EA",templateUrl:"app/components/feed/jh-main-feed.html",scope:{feed:"=",message:"@"},controllerAs:"vm",bindToController:!0,controller:function(){},link:function(e,t){e.$watch("vm.feed.getStream()",(function(e){var n=$("video",t)[0];null!=e?(n.muted=!0,Janus.attachMediaStream(n,e)):n.src=null}))}}})),function(){function e(e,t){return{restrict:"EA",templateUrl:"app/components/feed/jh-main-feed-info.html",scope:{},controllerAs:"vm",bindToController:!0,controller:function(){var n=this;n.name=function(){var t=e.findMain();return null!==t?t.display:""},n.makeNameEditable=function(){n.editing=!0},n.leaveEditingMode=function(){n.editing=!1,n.newName=null},n.editing=!1,n.isEditing=function(){return n.editing},n.updateName=function(){n.newName&&(e.findMain().updateDisplay(n.newName),t.go("room",{user:n.newName},{notify:!1})),this.leaveEditingMode()},n.newName=null,n.keyDetect=function(e){13===e.keyCode?(n.updateName(),n.leaveEditingMode()):27===e.keyCode&&n.leaveEditingMode()}}}}angular.module("janusHangouts").directive("jhMainFeedInfo",e),e.$inject=["FeedsService","$state"]}(),function(){function e(e,t,n,o){return{restrict:"EA",templateUrl:"app/components/feed/jh-feed.html",scope:{feed:"=",toggleHighlightFn:"&",highlighted:"=",highlightedByUser:"="},controllerAs:"vm",bindToController:!0,controller:function(){var e=this;e.mirrored=e.feed.isPublisher&&!e.feed.isLocalScreen,e.thumbnailTag=function(){return e.highlighted||e.feed.isIgnored?"placeholder":e.feed.getVideoEnabled()?e.feed.isPublisher||e.feed.getVideoSubscription()?"video":e.feed.getPicture()?"picture":"placeholder":"placeholder"},e.initPics=function(t){var n=$("canvas",t),o=n[0],i=$("video",t).first(),s=o.getContext("2d");o.width=n.width(),o.height=Math.round(.75*o.width);var r=new window.Image;r.src="assets/images/placeholder.png",r.onload=function(){s.drawImage(r,0,0,o.width,o.height)},e.picCanvas=n,e.picSource=i,e.picContext=s},e.takePic=function(){var t=e.picCanvas[0],n=t.width;if(e.picSource[0].videoHeight){var o=n*e.picSource[0].videoHeight/e.picSource[0].videoWidth;t.height=o,e.picContext.drawImage(e.picSource[0],0,0,n,o),e.feed.updateLocalPic(t.toDataURL("image/jpeg",.4))}}},link:function(e,i){e.$watch("vm.feed.getStream()",(function(t){if(null!=t){var n=$("video",i)[0];n.muted=e.vm.feed.isPublisher,Janus.attachMediaStream(n,t)}}));var s=e.vm,r=s.feed;if(r.isPublisher){if(s.initPics(i),s.takePic(),t(s.takePic,2e4),!r.isLocalScreen){var a=c();e.$on("muted.byRequest",(function(){a=l(3),o.muted()})),e.$on("muted.byUser",(function(){a=c()})),e.$on("muted.Join",(function(){a=c(),o.joinedMuted()})),e.$watch("vm.feed.isVoiceDetected()",(function(e){e&&!1===r.getAudioEnabled()&&c()>a&&(o.speaking(),a=l(60))}))}}else r.setVideoSubscription(n.videoThumbnails||s.highlighted),e.$watch((function(){return s.feed.isConnected()&&(n.videoThumbnails||s.highlighted||!s.feed.isSilent())}),(function(e){r.setVideoSubscription(e)}));function l(e){return Date.now()+1e3*e}function c(){return l(0)}}}}angular.module("janusHangouts").directive("jhFeed",e),e.$inject=["RoomService","$interval","jhConfig","MuteNotifier"]}(),function(){function e(e,t){var n=null,o={};this.find=function(e){return o[e]||null},this.findMain=function(){return n},this.add=function(e,t){o[e.id]=e,t&&t.main&&(n=e)},this.destroy=function(e){delete o[e],n&&e===n.id&&(n=null)},this.allFeeds=function(){return _.values(o)},this.publisherFeeds=function(){return _.filter(this.allFeeds(),(function(e){return e.isPublisher}))},this.localScreenFeeds=function(){return _.filter(this.allFeeds(),(function(e){return e.isLocalScreen}))},this.speakingFeed=function(){return _.detect(this.allFeeds(),(function(e){return e.getSpeaking()}))},this.waitFor=function(n,o,i){var s=e.defer(),r=this.find(n),a=this;if(o=o||10,i=i||1e3,null===r)var l=t.setInterval((function(){null===(r=a.find(n))?o-=1:(t.clearInterval(l),s.resolve(r)),0===o&&(t.clearInterval(l),s.reject("feed with id "+n+" was not found"))}),i);else s.resolve(r);return s.promise}}angular.module("janusHangouts").service("FeedsService",e),e.$inject=["$q","$window"]}(),function(){function e(e,t,n,o){return function(i){i=i||{};var s=this;this.id=i.id||0,this.display=i.display||null,this.isPublisher=i.isPublisher||!1,this.isLocalScreen=i.isLocalScreen||!1,this.isIgnored=i.ignored||!1,this.connection=i.connection||null;var r=null,a=!1,l=Date.now(),c=null,u=null,d=!0,h=!0;function g(n){e((function(){!1===s.isEnabled("audio")&&(n=!1),a!==n&&(a=n,!1===n&&(l=Date.now()),t.sendStatus(s,{exclude:"picture"}))}))}function f(e){if(null==c)return null;var t="get"+_.capitalize(e)+"Tracks";if(null===c[t]()||void 0===c[t]())return null;var n=c[t]()[0];return void 0===n?null:n}this.isEnabled=function(e){return this.isPublisher?this.connection&&this.connection.getConfig()?this.connection.getConfig()[e]:null:"audio"===e?h:d},this.isTrackEnabled=function(e){var t=f(e);return null!==t&&t.enabled},this.setEnabledTrack=function(e,t){var n=f(e);null!==n&&(n.enabled=t)},this.hasTrack=function(e){return null!==f(e)},this.setPicture=function(e){r=e},this.getPicture=function(){return r},this.setStream=function(e){this.isPublisher&&!this.isLocalScreen&&(u=new n(e,{start:function(){g(!0)},stop:function(){g(!1)}})),c=e},this.getStream=function(){return c},this.setSpeaking=function(e){a=e},this.getSpeaking=function(){return a},this.setAudioEnabled=function(e){h=e},this.getAudioEnabled=function(){return this.isEnabled("audio")},this.setVideoEnabled=function(e){d=e},this.getVideoEnabled=function(){return this.isEnabled("video")},this.isVoiceDetected=function(){return u&&u.isSpeaking()},this.isDataOpen=function(){return!!this.connection&&this.connection.isDataOpen},this.isConnected=function(){return null!==this.connection},this.disconnect=function(){this.connection&&this.connection.destroy(),u&&u.destroy(),this.connection=null,c=null},this.ignore=function(){this.isIgnored=!0,this.disconnect()},this.setConnection=function(e){this.isIgnored=!1,this.connection=e},this.setIsIgnored=function(e){this.isIgnored=e},this.waitingForConnection=function(){return!1===this.isIgnored&&!this.connection},this.setEnabledChannel=function(n,i,s){var r=this;if(s=s||{},this.isPublisher){var l={};l[n]=i,this.connection.setConfig({values:l,ok:function(){e((function(){"audio"===n&&!1===i&&(a=!1),s.after&&s.after(),t.sendStatus(r,{exclude:"picture"}),o.emitEvent({type:"channel",data:{channel:n,status:i,peerconnection:r.connection.pluginHandle.webrtcStuff.pc}})}))}}),"video"===n&&this.setEnabledTrack("video",i)}else"audio"===n&&!1===i&&t.sendMuteRequest(this)},this.updateLocalPic=function(n){var o=this;e((function(){r=n,t.sendStatus(o)}))},this.updateDisplay=function(n){var o=this;e((function(){o.setDisplay(n),t.sendStatus(o)}))},this.getDisplay=function(){return this.display},this.setDisplay=function(e){this.display=e},this.getStatus=function(e){(e=e||{}).exclude||(e.exclude=[]);var t={};return _.forEach(["audioEnabled","videoEnabled","speaking","picture","display"],(function(n){_.includes(e.exclude,n)||(t[n]=s["get"+_.capitalize(n)]())})),t},this.setStatus=function(t){var n=this;e((function(){!0===a&&!1===t.speaking&&(l=Date.now()),_.forEach(t,(function(e,t){n["set"+_.capitalize(t)](e)}))}))},this.isSilent=function(e){return e||(e=6e3),!a&&l<Date.now()-e},this.setVideoSubscription=function(e){null!==this.connection&&this.connection.setConfig({values:{video:e}})},this.getVideoSubscription=function(){return this.connection&&this.connection.getConfig()?this.connection.getConfig().video:null}}}angular.module("janusHangouts").factory("Feed",e),e.$inject=["$timeout","DataChannelService","SpeakObserver","EventsService"]}(),function(){function e(e,t){return function(n,o,i){var s=this;this.pluginHandle=n,this.role=i||"subscriber",this.isDataOpen=!1,this.config=null,console.log(this.role+" plugin attached ("+n.getPlugin()+", id="+n.getId()+")"),this.destroy=function(){t.emitEvent({type:"pluginHandle",data:{status:"detached",for:s.role,pluginHandle:s.pluginHandle}}),this.config=null,this.pluginHandle.detach()},this.register=function(e,t){var i={request:"join",room:o,ptype:"publisher",display:e,pin:t||""};n.send({message:i})},this.listen=function(e,t,i){var s={request:"join",room:o,ptype:"subscriber",feed:e,pin:t||"",private_id:i};n.send({message:s})},this.handleRemoteJsep=function(e){n.handleRemoteJsep({jsep:e})},this.sendData=function(e){n.data(e)},this.publish=function(o){o=o||{};var i={videoRecv:!1,audioRecv:!1},r={video:!0,audio:!0};"main"===this.role?(o.muted&&(r.audio=!1),o.noCamera?(i.videoSend=!1,r.video=!1):i.videoSend=!0,i.audioSend=!0,i.data=!0,r.data=!0):(r.audio=!1,r.data=!1,i.video=this.role,i.audioSend=!1,i.data=!1),n.createOffer({media:i,success:function(t){console.log("Got publisher SDP!"),console.log(t),s.config=new e(n,r,t),o.success&&o.success()},error:function(e){console.error("WebRTC error publishing"),console.error(e),t.emitEvent({type:"error",data:{status:"createOffer",error:e,peerconnection:s.pluginHandle.webrtcStuff.pc}}),o.error&&o.error()}})},this.subscribe=function(e){n.createAnswer({jsep:e,media:{audioSend:!1,videoSend:!1,data:!0},success:function(e){console.log("Got SDP!"),console.log(e);var t={request:"start",room:o};n.send({message:t,jsep:e})},error:function(e){console.error("WebRTC error subscribing"),console.error(e),t.emitEvent({type:"error",data:{status:"createAnswer",error:e,peerconnection:s.pluginHandle.webrtcStuff.pc}})}})},this.setConfig=function(t){this.config?this.config.set(t):this.config=new e(n,t.values,null,t.ok)},this.getConfig=function(){if(this.config)return this.config.get()},this.confirmConfig=function(){if(this.config)return this.config.confirm()},this.onDataOpen=function(){this.isDataOpen=!0}}}angular.module("janusHangouts").factory("FeedConnection",e),e.$inject=["ConnectionConfig","EventsService"]}(),function(){function e(e){return function(t,n,o,i){var s={},r=null,a={audio:!0,video:!0,data:!0},l=null;function c(e){return e.video!==a.video||e.audio!==a.audio}function u(e){e=e||{};var n={request:"configure"};r={},_.assign(r,s,a),_.assign(n,r),t.send({message:n,jsep:e.jsep,success:function(){l=e.ok},error:function(){r=null,console.error("Config request not sent")}})}_.assign(a,n),u({jsep:o,ok:i}),this.get=function(){return s},this.set=function(e){(e=e||{}).values=e.values||{};var t={};_.assign(t,s,a),_.assign(a,s,e.values),null===r&&c(t)&&u({ok:e.ok})},this.confirm=function(){e((function(){null===r?console.error("I haven't sent a config. Where does this confirmation come from?"):(s=r,r=null,console.log("Connection configured",s),l&&l(),c(s)&&u())}))}}}angular.module("janusHangouts").factory("ConnectionConfig",e),e.$inject=["$timeout"]}(),angular.module("janusHangouts").directive("autoFocus",["$timeout",function(e){return{restrict:"A",link:function(t,n,o){!1!==t.$eval(o.autoFocus)&&e((function(){t.$emit("focus",n[0]),n[0].focus()}))}}}]),angular.module("janusHangouts").service("EventsService",(function(){var e=null,t=null,n=null;this.init=function(){null==(n=new window.Rx.Subject)&&console.error("Could not load rx.js! Event emitter will not work.")},this.setUser=function(t){e=t},this.setRoom=function(e){t=e},this.getEventsSubject=function(){return n},this.emitEvent=function(o){o.user=e,o.room=t,o.timestamp=Date.now(),null==n?console.log("Event emitter is not configured. Event not emitted"):n.onNext(o)}})),angular.module("janusHangouts").directive("jhLogEntry",(function(){return{restrict:"EA",templateUrl:"app/components/chat/jh-log-entry.html",scope:{message:"="},controllerAs:"vm",bindToController:!0,controller:function(){this.text=this.message.text()}}})),angular.module("janusHangouts").directive("jhChat",(function(){return{restrict:"EA",templateUrl:"app/components/chat/jh-chat.html",scope:{messages:"="},link:function(e){e.$watch("vm.messages.length",(function(e){if(void 0!==e){var t=document.getElementById("jh-chat-messages");setTimeout((function(){t&&(t.scrollTop=t.scrollHeight)}),100)}}))},controllerAs:"vm",bindToController:!0,controller:function(){}}})),angular.module("janusHangouts").directive("jhChatMessage",(function(){return{restrict:"EA",templateUrl:"app/components/chat/jh-chat-message.html",scope:{message:"="},controllerAs:"vm",bindToController:!0,controller:function(){this.embedOptions={link:!0,linkTarget:"_blank",sanitizeHtml:!1,image:{embed:!0},pdf:{embed:!1},audio:{embed:!0},code:{highlight:!1},basicVideo:!0,tweetEmbed:!1}}}})),function(){function e(e){return{restrict:"EA",templateUrl:"app/components/chat/jh-chat-form.html",scope:{message:"="},controllerAs:"vm",bindToController:!0,controller:function(){var t=this;t.text=null,t.submit=function(){e.writeChatMessage(t.text),t.text=null}}}}angular.module("janusHangouts").directive("jhChatForm",e),e.$inject=["ActionService"]}(),function(){function e(e){return{restrict:"EA",templateUrl:"app/components/browser-info/jh-browser-info.html",scope:!0,controllerAs:"vm",bindToController:!0,controller:function(){this.showHelp=function(){e.open({animation:!0,templateUrl:"app/components/browser-info/browser-info.html",controller:"BrowserInfoCtrl",controllerAs:"vm"})}}}}angular.module("janusHangouts").directive("jhBrowserInfo",e),e.$inject=["$uibModal"]}(),function(){function e(e,t){this.usingSSL=function(){return t.usingSSL()},this.httpsUrl=function(){return t.httpsUrl()},this.close=function(){e.dismiss("cancel")}}angular.module("janusHangouts").controller("BrowserInfoCtrl",e),e.$inject=["$uibModalInstance","RequestService"]}(),angular.module("janusHangouts").controller("SigninController",(function(){})),function(){function e(e,t,n,o,i,s){var r=i.getRoom(),a=o.getUser(),l={};null===r||null===a?(null!==r&&(l.room=r.id),t.go("signin",l)):void 0===t.params.user?(l.room=r.id,l.user=a.username,t.go(t.current.name,l,{location:"replace"})):i.enter(a.username),e.$on("room.error",(function(e,n){"Unauthorized (wrong pin)"===n?t.go("signin",l):alert("Janus server reported the following error:\n"+n)})),e.$on("consentDialog.changed",(function(e,t){t?n.start():t||n.stop()})),s.bindTo(e).add({combo:"alt+m",description:"Mute or unmute your microphone",callback:function(){i.toggleChannel("audio")}}).add({combo:"alt+n",description:"Disable or enable camera",callback:function(){i.toggleChannel("video")}}).add({combo:"alt+q",description:"Sign out",callback:function(){o.signout()}}),e.hotkeys=s}angular.module("janusHangouts").controller("RoomCtrl",e),e.$inject=["$scope","$state","blockUI","UserService","RoomService","hotkeys"]}(),angular.module("janusHangouts.config",[]).provider("jhConfig",(function(){var e={janusServer:null,janusServerSSL:null,janusDebug:!1,janusWithCredentials:!0,httpsAvailable:!0,httpsUrl:null,videoThumbnails:!0,joinUnmutedLimit:3};return{$get:function(){return e},$set:function(t,n){e[t]=n}}})),angular.module("janusHangouts").run(["$templateCache",function(e){e.put("app/room/consent-dialog.html",'<img src="assets/images/up_arrow.png">'),e.put("app/room/room.html",'<div class="row" id="main-chat-session"><div jh-video-chat="true"></div></div>'),e.put("app/signin/signin.html",'<div id="signin"><jh-signin-form></jh-signin-form></div>'),e.put("app/templates/global-notification.html",'<style>\n  #global-notifications{position:fixed;z-index:1030;top:51px;left:0;text-align:center;background-color:#cfe1e9;color:#212121;width:100%;}\n  .global-notification{padding: 4px 10px;}\n  .global-notification .icon{margin-right:5px !important}\n  .global-notification .close-button{color:#777;margin-left:10px !important;cursor:pointer}\n  .global-notification .close-button:hover{color:#3b3b3b}\n  .global-notification.notification-warning{background-color:#ffe479}\n  .global-notification.notification-info{background-color:#9dd3eb}\n  .global-notification.notification-success{background-color:#C5ED73}\n  .global-notification.notification-error{background-color:#d9534f;color:#fff;}\n  .global-notification.notification-error .close-button{color:#fff}\n  .global-notification.notification-error .close-button:hover{color:#ff9898}\n</style><div class="global-notification notification-{{data.type}}"><i ng-class="data.faIcon" ng-if="data.faIcon" class="fa fa-fw icon"></i> <strong ng-if="data.title">{{data.title}}:&nbsp;</strong><span ng-click="close()" ng-if="data.closeButton" class="close-button pull-right">✖</span> <span>{{data.message}}</span> <a ng-repeat="action in data.actions" ng-click="action.fn()" ng-class="action.className">{{action.label}}</a></div>'),e.put("app/templates/gmail-notification.html",'<div class="gmail-template"><style scoped="">\n    .gmail-template {\n      position: relative;\n      right: 0;\n      left: 0;\n      margin: 4px 0;\n      text-align: center;\n    }\n    .gmail-template div {\n      position: relative;\n      display: inline-block;\n      margin: 0 auto;\n\n      border:1px solid rgb(240, 195, 109);\n      background-color: rgb(249, 237, 190);\n      font-size: 13px;\n      font-weight: bold;\n      padding:2px 8px 2px 8px;\n\n      -webkit-transition: opacity 0.5s ease-out 4s;\n      -moz-transition: opacity 0.5s ease-out 4s;\n      -o-transition: opacity 0.5s ease-out 4s;\n      transition: opacity 0.5s ease-out 4s;\n    }\n    .gmail-template .gmail-template-error {\n      background-color: #DD8181;\n      border: 1px solid #D54B4B;\n    }\n    .gmail-template-close {\n      color: #9E9E9E;\n    }\n    .gmail-template-close:hover {\n      color: #505050;\n    }\n    .gmail-template-error .gmail-template-close {\n      color: #777777;\n    }\n    .gmail-template-error .gmail-template-close:hover {\n      color: #3B3B3B;\n    }\n    .gmail-template a {\n      cursor: pointer;\n      text-decoration: underline;\n    }\n  </style><div ng-class="\'gmail-template-\' + data.type"><i class="fa fa-fw" ng-class="data.faIcon" ng-if="data.faIcon"></i> {{data.title}}: {{data.message}} <a ng-repeat="action in data.actions" ng-click="action.fn()" ng-class="action.className">{{action.label}}</a> <i class="fa fa-fw fa-times gmail-template-close" ng-click="close()" ng-if="data.faIcon && data.closeButton"></i> <span class="gmail-template-close" ng-click="close()" ng-if="!data.faIcon && data.closeButton">✖</span></div></div>'),e.put("app/components/browser-info/browser-info.html",'<div class="modal-header"><button type="button" class="close" ng-click="vm.close()" aria-label="Close"><span aria-hidden="true">&times;</span></button><h3 class="modal-title">Information about browsers</h3></div><div class="modal-body"><h4>Firefox</h4><p>At least Firefox 36 is required, a more recent version is recommended.</p><p>Firefox will refuse to use any bit rate lower than a certain limit (200 kbps by default). In some situations, a lower bit rate can be useful to save bandwidth and processing power in the clients. This limit can be adjusted (a sensible value would be 64) modifying the <code>media.peerconnection.video.min_bitrate</code> setting at <a href="about:config">about:config</a>.</p><h4>Chrom(e/ium)</h4><p>Jangouts has been successfully tested with Chromium 41. It will probably work with older versions as well, but the usage of a version as recent as possible is recommended (see exception below).</p><p>There is a known bug in Chromium 46 (and maybe other versions of both Chrome and Chromium) that causes it to crash during initialization of WebRTC connections when running in sandbox mode (which is the default). If Chrom(e/ium) crashes when entering a Jangouts room, close it and execute it again adding the <code>--no-sandbox</code> parameter to the command line.</p><p>Chrome and Chromium 47 (and probably more recent versions) seem to refuse to send WebRTC content (neither audio or video) over plain HTTP. <span ng-if="vm.usingSSL()">You should not be affected by that problem, since you are using a SSL (HTTPS) connection.</span> <span ng-if="!vm.usingSSL() && vm.httpsUrl()">To avoid this and other problems, it\'s probably a good idea to access the <a class="alert-link" ng-href="{{vm.httpsUrl()}}">SSL (HTTPS) version</a> of this site.</span></p></div><div class="modal-footer"><button class="btn btn-primary" ng-click="vm.close()">OK</button></div>'),e.put("app/components/browser-info/jh-browser-info.html",'<small><i class="fa fa-info-circle"></i> Tested with recent versions of Firefox, Chrome and Chromium. Please review the <a class="alert-link" href="#" ng-click="vm.showHelp()">detailed information</a> about browsers before proceeding.</small>'),e.put("app/components/chat/jh-chat-form.html",'<form name="chatMessage" ng-submit="vm.submit()"><div class="input-group"><input class="form-control input-sm" placeholder="Type your message here..." type="text" ng-model="vm.text" required=""> <span class="input-group-btn"><button class="btn btn-sm" ng-disabled="chatMessage.$invalid">Send</button></span></div></form>'),e.put("app/components/chat/jh-chat-message.html",'<div class="header"><strong>{{ vm.message.content.feed.display }}</strong> <small class="pull-right text-muted"><span class="glyphicon glyphicon-time"></span> {{ vm.message.timestamp | date:\'shortTime\' }}</small></div><ng-embed embed-data="vm.message.text()" embed-options="vm.embedOptions"></ng-embed>'),e.put("app/components/chat/jh-chat.html",'<div class="jh-chat panel panel-default"><div class="panel-body" id="jh-chat-messages"><ul><li ng-repeat="m in vm.messages"><jh-chat-message message="m" ng-if="m.type === \'chatMsg\'"></jh-chat-message><jh-log-entry message="m" ng-if="m.type !== \'chatMsg\'"></jh-log-entry></li></ul></div><div class="panel-footer" id="chat-form-footer"><jh-chat-form></jh-chat-form></div></div>'),e.put("app/components/chat/jh-log-entry.html",'<span class="log-entry">{{ vm.text }}</span>'),e.put("app/components/feed/jh-feed.html",'<figure ng-class="{\'own-feed\': vm.feed.isPublisher, sticky: vm.highlightedByUser}"><div class="thumb" ng-click="vm.toggleHighlightFn()"><video autoplay="" class="face" ng-class="{mirrored: vm.mirrored}" poster="assets/images/placeholder.png" ng-show="vm.thumbnailTag() === \'video\'"></video><img ng-src="{{vm.feed.getPicture()}}" class="face" ng-class="{mirrored: vm.mirrored}" ng-show="vm.thumbnailTag() === \'picture\'"> <img ng-src="assets/images/placeholder.png" class="face" ng-class="{mirrored: vm.mirrored}" ng-show="vm.thumbnailTag() === \'placeholder\'"><canvas ng-show="false"></canvas></div><figcaption ng-init="buttons=false"><span class="caption" ng-class="{dropdown: buttons, dropup: !buttons}" ng-click="buttons=!buttons"><span class="caret"></span> {{ vm.feed.display }}</span><div class="buttons"><jh-unpublish-button feed="vm.feed"></jh-unpublish-button><jh-audio-button feed="vm.feed" with-monitor="true"></jh-audio-button></div><div class="additional-buttons" ng-show="buttons"><jh-sticky-button feed="vm.feed" click-fn="buttons=false; vm.toggleHighlightFn()" highlighted="vm.highlighted" sticky="vm.highlightedByUser"></jh-sticky-button><jh-video-button feed="vm.feed" ng-click="buttons=false"></jh-video-button><jh-ignore-button feed="vm.feed" ng-click="buttons=false"></jh-ignore-button><jh-ignore-audio-button feed="vm.feed" ng-click="buttons=false"></jh-ignore-audio-button></div></figcaption></figure>'),e.put("app/components/feed/jh-main-feed-info.html",'<span><div class="name-edit" ng-show="vm.isEditing()"><input ng-if="vm.isEditing()" ng-keydown="vm.keyDetect($event)" ng-blur="vm.leaveEditingMode()" ng-model="vm.newName" placeholder="new name" auto-focus=""> <span class="glyphicon glyphicon-question-sign" title="Press Enter to change&#013; Press Escape to keep"></span></div><span class="feed-info" title="Click to Edit Name" ng-click="vm.makeNameEditable()" ng-hide="vm.isEditing()">{{ vm.name() }}</span></span>'),e.put("app/components/feed/jh-main-feed.html",'<video autoplay=""></video>'),e.put("app/components/room/jh-leave-button.html",'<button class="btn" ng-click="vm.leave()" title="Sign out"><span class="glyphicon glyphicon-log-out" aria-hidden="true"></span></button>'),e.put("app/components/room/jh-room-info.html",'<span class="room-info">{{ vm.name() }}</span>'),e.put("app/components/screen-share/jh-screen-share-button-moz.html","<jh-screen-share-sub-button source=\"'window'\" icon=\"'modal-window'\" label=\"'Share a window'\"></jh-screen-share-sub-button><jh-screen-share-sub-button source=\"'screen'\" icon=\"'blackboard'\" label=\"'Share the desktop'\"></jh-screen-share-sub-button>"),e.put("app/components/screen-share/jh-screen-share-button.html","<jh-screen-share-sub-button source=\"'screen'\" icon=\"'blackboard'\" label=\"'Share a window/desktop'\"></jh-screen-share-sub-button>"),e.put("app/components/screen-share/jh-screen-share-hint.html",'<small ng-if="vm.visible()"><span ng-if="vm.usingSSL()">If you wish to use the screen sharing functionality, make sure you have understood <a class="alert-link" href="#" ng-click="vm.showHelp()">these instructions</a>.</span> <span ng-if="!vm.usingSSL()">Screen sharing will not work without SSL. If you want to make use of that functionality, access the <a class="alert-link" ng-href="{{vm.httpsUrl()}}">HTTPS version</a> of this site.</span></small>'),e.put("app/components/screen-share/jh-screen-share-sub-button.html",'<div style="display: inline-block;" uib-tooltip="{{vm.title()}}" tooltip-placement="bottom"><button class="btn" ng-disabled="!vm.enabled()" ng-click="vm.click()"><span class="glyphicon glyphicon-{{vm.icon}}" aria-hidden="true"></span></button></div>'),e.put("app/components/screen-share/screen-share-help.html",'<div class="modal-header"><button type="button" class="close" ng-click="vm.close()" aria-label="Close"><span aria-hidden="true">&times;</span></button><h3 class="modal-title">Screen sharing</h3></div><div class="modal-body"><p>Sharing your screen is an experimental feature in WebRTC and only works if the browser you\'re using meets particular requirements.</p><p>Active screen/window sharing will only work from Firefox if you have at least version 33 installed. In addition, two adjustments must be done in the settings at <a href="about:config">about:config</a>. First, make sure <code>media.getusermedia.screensharing.enabled</code> is enabled. Then, make sure <code>{{ vm.hostname() }}</code> is listed in <code>media.getusermedia.screensharing.allowed_domains</code>.</p><p>If you\'re using a recent version of Chrome (34+), you\'ll need to install <a href="https://chrome.google.com/webstore/detail/janus-webrtc-screensharin/hapfgfdkleiggjjpfpenajgdnfckjpaj">this extension</a>. If you\'re using an older verson of Chrome, instead, you\'ll need to manually enable the Chrome flag <a href="chrome://flags/#enable-usermedia-screen-capture">chrome://flags/#enable-usermedia-screen-capture</a>. Otherwise you\'ll get a permission error. Moreover, please beware that some versions of Chrome may only support the feature if you explicitly pass the <code>--enable-usermedia-screen-capturing</code> parameter on the command line.</p></div><div class="modal-footer"><button class="btn btn-primary" ng-click="vm.close()">OK</button></div>'),e.put("app/components/user/jh-signin-form.html",'<div class="form-signin"><div class="text-center"><img src="images/jangouts-logo.png" class="jangouts-logo-login"></div><form ng-submit="vm.signin()"><div class="form-group"><label class="sr-only" for="inputUsername">Username</label> <input id="inputUsername" class="form-control input-lg" type="text" ng-model="vm.username" required="true" placeholder="Username"></div><div class="form-group"><label class="sr-only" for="inputRoom">Room</label> <span ng-if="vm.showRoom()">{{ vm.room.label }}</span><select ng-if="vm.showRoomsList()" id="inputRoom" class="form-control input-lg" ng-model="vm.room" required="true" ng-options="room.label for room in vm.rooms track by room.id"><option value="" disabled="" selected="">Select a room</option></select></div><div ng-show="vm.room.pin_required" class="form-group"><label class="sr-only" for="inputPin">Pin</label> <span>Please enter the right Pin to access this Room!</span> <input id="inputPin" class="form-control input-lg" type="password" ng-model="vm.enteredPin" placeholder="Pin (required)"></div><jh-thumbnails-mode-button text-template="true"></jh-thumbnails-mode-button><button id="signInButton" class="btn btn-lg btn-primary btn-block" type="submit">Sign in</button></form><div class="login-msg"><jh-browser-info></jh-browser-info><hr><jh-screen-share-hint></jh-screen-share-hint></div></div>'),e.put("app/components/videochat/jh-video-chat.html",'<div class="row"><header><div class="row"><div class="col-xs-6 col-sm-5"><jh-room-info></jh-room-info><button class="btn" ng-click="vm.showHotkeys()" title="Keyboard shortcuts"><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span></button><jh-thumbnails-mode-button></jh-thumbnails-mode-button><jh-resize-mode-button toggle-fn="vm.toggleWindowResizeMode()" reset-fn="vm.setDefaultLayout()" resize-mode-on="vm.windowResizeModeOn"></jh-resize-mode-button><jh-leave-button></jh-leave-button></div><div class="hidden-xs col-sm-2 text-center"><img src="images/jangouts-logo.png" id="logo"></div><div class="col-xs-6 col-sm-5 text-right"><jh-main-feed-info></jh-main-feed-info><jh-screen-share-button></jh-screen-share-button><jh-video-button feed="vm.mainFeed()"></jh-video-button><jh-pushtotalk-button></jh-pushtotalk-button><jh-audio-button feed="vm.mainFeed()"></jh-audio-button></div></div></header></div><div class="row" id="videochat-body"><div gridster="vm.gridsterOpts" id="videochat-playroom"><ul><li gridster-item="" row="item.position[0]" col="item.position[1]" size-x="item.size[0]" size-y="item.size[1]" ng-repeat="item in vm.gridsterItems"><div ng-if="item.content === \'Speaker\'" class="grid-item-content" id="main-video" jh-main-feed="true" feed="vm.highlightedFeed()" ng-class="{mirrored: vm.mirrored()}"></div><div ng-if="item.content === \'Participants\'" class="grid-item-content" id="thumbnails"><div jh-feed="true" feed="f" ng-repeat="f in vm.feeds() | orderBy:\'+display\'" toggle-highlight-fn="vm.toggleHighlightedFeed(f)" highlighted="vm.isHighlighted(f)" highlighted-by-user="vm.isHighlightedByUser(f)"></div></div><div ng-if="item.content === \'Chat\'" class="grid-item-content"><jh-chat messages="vm.logEntries()"></jh-chat></div></li></ul></div></div>'),e.put("app/components/feed/buttons/jh-audio-button.html",'<button type="button" class="btn" ng-class="{\'btn-primary\': vm.isSpeaking(), \'btn-default\': !vm.isSpeaking()}" ng-click="vm.toggle()" title="Disable audio" ng-show="vm.showsDisable()"><span class="glyphicon glyphicon-volume-up"></span></button><button type="button" class="btn btn-danger" ng-click="vm.toggle()" title="Enable audio" ng-show="vm.showsEnable()"><span class="glyphicon glyphicon-volume-off"></span></button><button type="button" disabled="" class="btn btn-danger" title="Audio disabled" ng-show="vm.showsAudioOff()"><span class="glyphicon glyphicon-volume-off"></span></button>'),e.put("app/components/feed/buttons/jh-ignore-audio-button.html",'<button type="button" class="btn btn-default" ng-click="vm.toggle()" title="Don\'t play audio" ng-show="vm.showsIgnore()"><span class="glyphicon glyphicon-volume-off"></span></button><button type="button" class="btn btn-danger" ng-click="vm.toggle()" title="Restore audio" ng-show="vm.showsStopIgnoring()"><span class="glyphicon glyphicon-volume-off"></span></button>'),e.put("app/components/feed/buttons/jh-ignore-button.html",'<button type="button" class="btn btn-default" ng-click="vm.ignore()" title="Ignore" ng-show="vm.showsIgnore()"><span class="glyphicon glyphicon-ban-circle"></span></button><button type="button" class="btn btn-danger" ng-click="vm.stopIgnoring()" title="Stop ignoring" ng-show="vm.showsStopIgnoring()"><span class="glyphicon glyphicon-ban-circle"></span></button>'),e.put("app/components/feed/buttons/jh-pushtotalk-button.html",'<button ng-class="{\'btn-danger\': vm.isRecording() }" class="btn push-to-talk" ng-click="vm.click($event)" title="{{vm.titleText}}"><span class="glyphicon glyphicon-bullhorn" aria-hidden="true"></span> <span ng-show="vm.showHotkey"><kbd>{{vm.hotkey}}</kbd></span> <span class="toggle-text">{{vm.toggleText}}</span></button>'),e.put("app/components/feed/buttons/jh-sticky-button.html",'<button type="button" class="btn btn-default" ng-click="vm.click()" title="Sticky as main video" ng-show="vm.showsEnable()"><span class="glyphicon glyphicon-pushpin"></span></button><button type="button" class="btn btn-danger" ng-click="vm.click()" title="Unstick" ng-show="vm.showsDisable()"><span class="glyphicon glyphicon-pushpin"></span></button>'),e.put("app/components/feed/buttons/jh-unpublish-button.html",'<button type="button" class="btn btn-default" ng-click="vm.click()" title="Stop sharing" ng-show="vm.isVisible()"><span class="glyphicon glyphicon-remove"></span></button>'),e.put("app/components/feed/buttons/jh-video-button.html",'<button type="button" class="btn btn-default" ng-click="vm.toggle()" title="Disable video" ng-show="vm.showsDisable()"><span class="glyphicon glyphicon-eye-open"></span></button><button type="button" class="btn btn-danger" ng-click="vm.toggle()" title="Enable video" ng-show="vm.showsEnable()"><span class="glyphicon glyphicon-eye-close"></span></button>'),e.put("app/components/videochat/buttons/jh-resize-mode-button.html",'<button ng-show="vm.showsReset()" class="btn" ng-click="vm.reset()" title="Reset layout to default"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></button> <button ng-class="{ \'btn-danger\': vm.resizeModeOn }" class="btn" ng-click="vm.toggle()" title="{{vm.title()}}"><span class="glyphicon glyphicon-pushpin" aria-hidden="true"></span></button>'),e.put("app/components/videochat/buttons/jh-thumbnails-mode-button-with-text.html",'<div class="checkbox" uib-tooltip="Disable to lower bandwidth and CPU usage" tooltip-placement="bottom"><label><input type="checkbox" ng-checked="vm.isChecked()" ng-click="vm.click()">Video thumbnails</label></div>'),e.put("app/components/videochat/buttons/jh-thumbnails-mode-button.html",'<button ng-class="{ \'btn-danger\': !vm.isChecked() }" class="btn" ng-click="vm.click()" title="Toggle Picture/Video thumbnails. Use picture mode to lower bandwidth and CPU usage"><span class="glyphicon" ng-class="{ \'glyphicon-picture\': !vm.isChecked(), \'glyphicon-facetime-video\': vm.isChecked() }" aria-hidden="true"></span></button>'),e.put("app/components/footer/jh-footer.html",'<footer class="footer"><div class="container-fluid"><span class="pull-left">&copy; <a href="http://www.suse.com/" target="_blank">SUSE 2015</a></span><span class="pull-right">Version 0.5.0</span><div class="clearfix"></div></div></footer>')}]);